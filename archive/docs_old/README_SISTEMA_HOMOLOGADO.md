# ğŸš€ Red Soluciones ISP v4.0 Homologado

## Sistema Empresarial Completo con IA Integrada

Red Soluciones ISP v4.0 es un sistema empresarial completamente homologado que integra Google Sheets como backend, IA empresarial con Gemini, y un dashboard reactivo en tiempo real.

---

## ğŸ¯ **CaracterÃ­sticas Principales**

### âœ… **Backend Google Sheets Unificado**
- **Context Engine**: Motor de contexto que mapea TODAS las hojas del Google Sheets
- **SincronizaciÃ³n inteligente**: ActualizaciÃ³n automÃ¡tica y cache con invalidaciÃ³n selectiva
- **Relaciones automÃ¡ticas**: Mapeo de relaciones entre clientes, incidentes, zonas, etc.
- **Filtrado por propietario**: Datos automÃ¡ticamente filtrados para Eduardo y Omar

### ğŸ¤– **IA Empresarial Avanzada**
- **Enhanced AI Agent**: Agente IA que comprende completamente el contexto del negocio
- **Respuestas contextuales**: Utiliza datos reales del Google Sheets para respuestas precisas
- **Acciones ejecutables**: Puede realizar operaciones directamente en el sistema
- **Insights automÃ¡ticos**: Genera anÃ¡lisis y recomendaciones de negocio

### ğŸ“Š **Dashboard Reactivo**
- **MÃ©tricas en tiempo real**: KPIs actualizados automÃ¡ticamente
- **PersonalizaciÃ³n por usuario**: Dashboard especÃ­fico para Eduardo y Omar
- **Widgets inteligentes**: Componentes que se actualizan segÃºn el contexto
- **Insights visuales**: GrÃ¡ficos y anÃ¡lisis automÃ¡ticos

### ğŸ” **Sistema de AutenticaciÃ³n**
- **Reconocimiento automÃ¡tico**: IdentificaciÃ³n entre Eduardo y Omar
- **Contexto personalizado**: Datos filtrados segÃºn el propietario
- **Permisos granulares**: Control de acceso por usuario y mÃ³dulo
- **Sesiones persistentes**: Mantiene la sesiÃ³n entre recargas

---

## ğŸ—ï¸ **Arquitectura del Sistema**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND REACTIVO                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    Dashboard    â”‚  â”‚   Chat con IA   â”‚  â”‚  GestiÃ³n    â”‚  â”‚
â”‚  â”‚   Inteligente   â”‚  â”‚   Empresarial   â”‚  â”‚  Usuarios   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND HOMOLOGADO                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Enhanced Agent  â”‚  â”‚ Context Engine  â”‚  â”‚  FastAPI    â”‚  â”‚
â”‚  â”‚  (IA Gemini)    â”‚  â”‚ (Contexto Real) â”‚  â”‚  Server     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  GOOGLE SHEETS BACKEND                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Clientes   â”‚  â”‚ Prospectos  â”‚  â”‚    Incidentes       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ EstadÃ­sticasâ”‚  â”‚    Zonas    â”‚  â”‚   Propietarios      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ **InstalaciÃ³n y ConfiguraciÃ³n**

### **1. Requisitos del Sistema**
```bash
Python 3.8+
Google Sheets API habilitada
Cuenta de servicio de Google configurada
```

### **2. Variables de Entorno**
Crear archivo `.env` en la raÃ­z del proyecto:

```env
# CONFIGURACIÃ“N PRINCIPAL
GOOGLE_SHEET_ID=tu_id_de_google_sheets
GOOGLE_SERVICE_ACCOUNT_FILE=service_account.json

# IA (OPCIONAL)
GEMINI_API_KEY=tu_api_key_de_gemini

# SERVIDOR
PORT=8004
DEBUG=false
ENVIRONMENT=production

# TELEGRAM (OPCIONAL)
TELEGRAM_BOT_TOKEN=tu_token_de_telegram
```

### **3. InstalaciÃ³n de Dependencias**
```bash
pip install -r requirements.txt
```

### **4. ConfiguraciÃ³n de Google Sheets**
1. Crear proyecto en Google Cloud Console
2. Habilitar Google Sheets API
3. Crear cuenta de servicio
4. Descargar archivo `service_account.json`
5. Compartir Google Sheets con email de la cuenta de servicio

---

## ğŸ’» **Uso del Sistema**

### **EjecuciÃ³n BÃ¡sica**
```bash
# Ejecutar sistema completo
python run_homologated_system.py

# Modo desarrollo (hot reload)
python run_homologated_system.py --dev

# Puerto personalizado
python run_homologated_system.py --port 8005

# Solo verificar configuraciÃ³n
python run_homologated_system.py --check
```

### **InicializaciÃ³n Completa**
```bash
# Inicializar sistema completo
python init_homologated_system.py

# Solo verificar configuraciÃ³n
python init_homologated_system.py --check-only

# Limpiar cache y reinicializar
python init_homologated_system.py --reset-cache
```

### **Acceso al Sistema**
- **Dashboard Principal**: `http://localhost:8004`
- **API v2**: `http://localhost:8004/api/v2/`
- **Estado del Sistema**: `http://localhost:8004/api/v2/system/status`

---

## ğŸ¯ **Funcionalidades Empresariales**

### **1. GestiÃ³n de Clientes**
- âœ… Vista completa de cartera de clientes
- âœ… Filtrado automÃ¡tico por propietario (Eduardo/Omar)
- âœ… BÃºsqueda inteligente con IA
- âœ… Relaciones con incidentes y zonas

### **2. Pipeline de Prospectos**
- âœ… GestiÃ³n completa de leads
- âœ… Seguimiento de conversiÃ³n
- âœ… Probabilidades automÃ¡ticas
- âœ… AsignaciÃ³n por zona

### **3. GestiÃ³n de Incidentes**
- âœ… Sistema de tickets completo
- âœ… PriorizaciÃ³n automÃ¡tica
- âœ… AsignaciÃ³n de tÃ©cnicos
- âœ… Escalamiento por tiempo

### **4. Analytics Empresarial**
- âœ… KPIs en tiempo real
- âœ… MÃ©tricas por propietario
- âœ… AnÃ¡lisis de churn y crecimiento
- âœ… Predicciones con IA

### **5. Chat IA Empresarial**
- âœ… Comprende todo el contexto del negocio
- âœ… Respuestas con datos reales
- âœ… Acciones ejecutables
- âœ… Sugerencias inteligentes

---

## ğŸ§  **Capacidades de IA**

### **Consultas Inteligentes**
```
â“ "Â¿CuÃ¡ntos clientes tiene Eduardo?"
âœ… "Eduardo tiene 45 clientes activos, generando $12,350/mes"

â“ "Incidentes de alta prioridad"  
âœ… "3 incidentes crÃ­ticos: ConexiÃ³n cliente GarcÃ­a (Zona Norte), 
    Servicio intermitente LÃ³pez (Zona Sur)..."

â“ "Estado del negocio este mes"
âœ… "Crecimiento +8%, ARPU $32.50, Churn 3.2% - 
    Excelente rendimiento vs objetivo"
```

### **Insights AutomÃ¡ticos**
- ğŸ” **AnÃ¡lisis de patrones**: Detecta tendencias en datos
- âš ï¸ **Alertas proactivas**: Identifica problemas antes que escaliden
- ğŸ’¡ **Oportunidades de negocio**: Sugiere acciones para crecimiento
- ğŸ“ˆ **Predicciones**: Estima crecimiento y mÃ©tricas futuras

---

## ğŸ“Š **Estructura de Google Sheets**

### **Hoja "Clientes"**
| ID | Nombre | Plan | Estado | Zona | Propietario | Pago_Mensual |
|----|--------|------|--------|------|-------------|--------------|
| 1  | GarcÃ­a | Premium | Activo | Norte | Eduardo | 45.00 |

### **Hoja "Prospectos"** 
| ID | Nombre | Telefono | Estado | Propietario | Probabilidad |
|----|--------|----------|--------|-------------|--------------|
| 1  | LÃ³pez | 555-0123 | Interesado | Omar | 70% |

### **Hoja "Incidentes"**
| ID | Cliente_ID | Tipo | Estado | Prioridad | Propietario |
|----|------------|------|--------|-----------|-------------|
| 1  | 1 | TÃ©cnico | Abierto | Alta | Eduardo |

### **Hojas Adicionales**
- ğŸ“ˆ **EstadÃ­sticas**: KPIs histÃ³ricos y mÃ©tricas
- ğŸ  **Zonas**: Sectores geogrÃ¡ficos de cobertura  
- ğŸ‘¥ **Propietarios**: ConfiguraciÃ³n de Eduardo y Omar

---

## ğŸ”§ **API Endpoints v2**

### **Sistema**
```
GET  /api/v2/system/status              # Estado del sistema
POST /api/v2/system/refresh             # Refrescar datos
```

### **Contexto**
```
GET  /api/v2/context/{propietario}      # Contexto completo del usuario
GET  /api/v2/dashboard/{propietario}    # Dashboard personalizado
```

### **IA y Chat**
```
POST /api/v2/chat/enhanced              # Chat con IA empresarial
GET  /api/v2/insights/{propietario}     # Insights automÃ¡ticos
```

### **BÃºsqueda**
```
GET  /api/v2/entities/search?q=...      # BÃºsqueda avanzada
```

---

## ğŸ› **Debugging y Logs**

### **Logs del Sistema**
```bash
# Ver logs en tiempo real
tail -f logs/redsoluciones_homologado.log

# Logs por fecha
ls logs/redsol_*.log
```

### **Debug del Context Engine**
```python
# Verificar estado del cache
GET /api/v2/system/status

# Limpiar cache manualmente
POST /api/v2/system/refresh
```

### **Debug del Enhanced Agent**
```python
# Probar agente IA directamente
POST /api/v2/chat/enhanced
{
  "message": "debug: estado del sistema",
  "user_name": "Eduardo"
}
```

---

## ğŸš¨ **Troubleshooting**

### **Problema: "Context Engine no disponible"**
```bash
# Verificar configuraciÃ³n
python run_homologated_system.py --check

# Reinicializar sistema
python init_homologated_system.py --reset-cache
```

### **Problema: "Google Sheets no accesible"**
1. Verificar `GOOGLE_SHEET_ID` en `.env`
2. Confirmar permisos de `service_account.json`
3. Compartir hoja con email de cuenta de servicio

### **Problema: "IA no disponible"**
1. Configurar `GEMINI_API_KEY` en `.env`
2. Verificar cuota de API de Gemini
3. Sistema funciona sin IA (funcionalidad limitada)

---

## ğŸ“ˆ **Roadmap y Mejoras**

### **v4.1 - PrÃ³ximas Funcionalidades**
- [ ] Dashboard mÃ³vil responsivo
- [ ] Notificaciones push en tiempo real
- [ ] IntegraciÃ³n con WhatsApp Business
- [ ] Reportes automatizados por email

### **v4.2 - IA Avanzada**
- [ ] Predicciones de churn por cliente
- [ ] Recomendaciones de precios dinÃ¡micas
- [ ] Chatbot para clientes
- [ ] AnÃ¡lisis de sentimientos

### **v5.0 - ExpansiÃ³n**
- [ ] Multi-tenant para otras ISPs
- [ ] IntegraciÃ³n con sistemas de facturaciÃ³n
- [ ] App mÃ³vil nativa
- [ ] API pÃºblica para integraciones

---

## ğŸ¤ **ContribuciÃ³n y Soporte**

### **Estructura del Proyecto**
```
red-soluciones-isp/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ core/                 # ConfiguraciÃ³n central
â”‚   â”‚   â”œâ”€â”€ services/             # Servicios principales
â”‚   â”‚   â”‚   â”œâ”€â”€ context_engine.py # Motor de contexto
â”‚   â”‚   â”‚   â”œâ”€â”€ enhanced_agent.py # IA empresarial
â”‚   â”‚   â”‚   â””â”€â”€ sheets/           # Google Sheets
â”‚   â”‚   â””â”€â”€ utils/                # Utilidades
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”‚   â”œâ”€â”€ enhanced-system.js # Sistema homologado
â”‚   â”‚   â”‚   â””â”€â”€ new-script.js      # Legacy
â”‚   â”‚   â””â”€â”€ css/
â”‚   â””â”€â”€ index.html                # Dashboard principal
â”œâ”€â”€ logs/                         # Logs del sistema
â”œâ”€â”€ init_homologated_system.py    # Inicializador
â”œâ”€â”€ run_homologated_system.py     # Ejecutor principal
â””â”€â”€ requirements.txt              # Dependencias
```

### **Contacto**
- ğŸ“§ **Email**: soporte@redsoluciones.com
- ğŸ’¬ **Chat**: Sistema integrado en dashboard
- ğŸ“± **Telegram**: Bot empresarial (si configurado)

---

## ğŸ“„ **Licencia**

Copyright Â© 2025 Red Soluciones ISP. Todos los derechos reservados.

Sistema empresarial desarrollado especÃ­ficamente para Red Soluciones ISP con tecnologÃ­a homologada y IA integrada.

---

**ğŸ‰ Â¡Disfruta de tu sistema empresarial completamente homologado!**
